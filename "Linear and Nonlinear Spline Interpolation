import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import CubicSpline

# ğŸ”¹ ç‚¹ã®å®šç¾©
A, B = 3, 90
C, D = 5, 100

# ğŸ”¹ ç›´ç·šéƒ¨åˆ† (0,0) â†’ (A,B)
x1 = np.linspace(0, A, 10)
y1 = (B / A) * x1  # y = (B/A) * x ã®ç›´ç·šå¼

# ğŸ”¹ ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“ç”¨ã®ãƒ‡ãƒ¼ã‚¿ (A,B) â†’ (C,D)
x2 = np.array([A, (A+C)/2, C])  # è£œé–“ç”¨ã®3ç‚¹
y2 = np.array([B, (B+D)/2 + 5, D])  # æ»‘ã‚‰ã‹ã«å¤‰åŒ–ã™ã‚‹ä¸­é–“ç‚¹ã‚’è¿½åŠ 

# ğŸ”¹ éç·šå½¢ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“ï¼ˆCubicSplineï¼‰
spline = CubicSpline(x2, y2, bc_type='natural')  # è‡ªç„¶å¢ƒç•Œæ¡ä»¶
x_spline = np.linspace(A, C, 50)
y_spline = spline(x_spline)

# ğŸ”¹ ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(8, 5))
plt.plot(x1, y1, label="Linear (0,0) â†’ (A,B)", color='b', linestyle='--', marker='o')
plt.plot(x_spline, y_spline, label="Nonlinear Spline (A,B) â†’ (C,D)", color='r', linestyle='-', marker='x')

# ğŸ”¹ è£œé–“ç‚¹ã‚’å¼·èª¿è¡¨ç¤º
plt.scatter([A, C], [B, D], color='black', zorder=3, label="Key Points")

plt.xlabel("X")
plt.ylabel("Y")
plt.title("Linear and Nonlinear Spline Interpolation")
plt.legend()
plt.grid()
plt.show()
